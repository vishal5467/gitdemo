if (self.CavalryLogger) { CavalryLogger.start_js(["\/pbfK"]); }

__d("SubscribeStatuses",[],(function a(b,c,d,e,f,g){f.exports={CANNOT_SUBSCRIBE:"CANNOT_SUBSCRIBE",IS_SUBSCRIBED:"IS_SUBSCRIBED",CAN_SUBSCRIBE:"CAN_SUBSCRIBE"}}),null);
__d("CameraPostBucketOwnerHelper",["idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={getId:function i(j){var k;return((k=j)!=null?k.id:k)||""},getName:function i(j){var k;return((k=j)!=null?k.name:k)||""},getGender:function i(j){if(!j)return"";return j.gender?j.gender:""},isEventHost:function i(j){if(!j)return false;return j.is_viewer_host?!!j.is_viewer_host:false},isViewerFriend:function i(j){if(!j)return false;return j.is_viewer_friend?!!j.is_viewer_friend:false},getSubscribeStatus:function i(j){if(!j)return null;return j.subscribe_status?j.subscribe_status:null},getProfilePictureUri:function i(j){if(!j||!j.profile_picture)return"";return j.profile_picture.uri||""},getCoverPhotoUri:function i(j){var k;if(!j||!j.cover_photo)return"";return((k=j)!=null?(k=k.cover_photo)!=null?(k=k.photo)!=null?(k=k.image)!=null?k.uri:k:k:k:k)||""},isViewerPageContentAdmin:function i(j){var k=h._getViewerProfilePermissions(j);return k&&k.includes("CREATE_CONTENT")||false},_getViewerProfilePermissions:function i(j){var k;if(!j||!j.viewer_profile_permissions)return null;return((k=j)!=null?k.viewer_profile_permissions:k)||null}};f.exports=h}),null);
__d("CameraPostMediaHelper",["idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={getId:function i(j){var k;return((k=j)!=null?k.id:k)||""},getWidth:function i(j){if(!j)return 0;if(j.width)return j.width;if(j.image)return j.image.width||0;return 0},getHeight:function i(j){if(!j)return 0;if(j.height)return j.height;if(j.image)return j.image.height||0;return 0},getType:function i(j){var k;return((k=j)!=null?k.__typename:k)||""},getImageUri:function i(j){if(!j)return null;return j.image?j.image.uri:null},isImage:function i(j){return h.getType(j)==="Photo"},isVideo:function i(j){return h.getType(j)==="Video"},getPreviewImage:function i(j){if(!j)return null;return j.preview_image?j.preview_image.uri:null}};f.exports=h}),null);
__d("CameraPostThreadOwnerHelper",["idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={getId:function i(j){var k;return(k=j)!=null?k.id:k},getName:function i(j){var k;return((k=j)!=null?k.name:k)||""},getIsViewerFriend:function i(j){var k;return!!((k=j)!=null?k.is_viewer_friend:k)},getProfilePictureUri:function i(j){var k;return((k=j)!=null?(k=k.profile_picture)!=null?k.uri:k:k)||""}};f.exports=h}),null);
__d("CameraPostTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({DIRECT:"DIRECT",GROUP_DIRECT:"GROUP_DIRECT",DIRECT_NUX:"DIRECT_NUX",STORY:"STORY",STORY_NUX:"STORY_NUX",PAGE_STORY:"PAGE_STORY",EVENT_STORY:"EVENT_STORY",BIRTHDAY_STORY:"BIRTHDAY_STORY",GROUP_STORY:"GROUP_STORY",LIVE_STORY:"LIVE_STORY",PROMOTION_STORY:"PROMOTION_STORY"})}),null);
__d("CameraPostTypesHelper",["CameraPostTypes"],(function a(b,c,d,e,f,g){"use strict";var h={isEventStory:function i(j){return j===c("CameraPostTypes").EVENT_STORY},isGroupStory:function i(j){return j===c("CameraPostTypes").GROUP_STORY},isPageStory:function i(j){return j===c("CameraPostTypes").PAGE_STORY},isPromotionStory:function i(j){return j===c("CameraPostTypes").PROMOTION_STORY},isStory:function i(j){return j===c("CameraPostTypes").STORY},isStoryNux:function i(j){return j===c("CameraPostTypes").STORY_NUX}};f.exports=h}),null);
__d("FBStoriesActionTypes",[],(function a(b,c,d,e,f,g){var h=Object.freeze({LOAD:"FB_STORIES.LOAD",LOADING:"FB_STORIES.LOADING",LOADED:"FB_STORIES.LOADED",LOADED_ERROR:"FB_STORIES.LOADED_ERROR",VIEWER_LIST_LOADED_FOR_THREAD:"FB_STORIES.VIEWER_LIST_LOADED_FOR_THREAD",RESET_LOCAL_SEEN_HISTORY:"FB_STORIES.RESET_LOCAL_SEEN_HISTORY",SELECTED_BUCKET_IDX_CHANGED:"FB_STORIES.SELECTED_BUCKET_IDX_CHANGED",SET_ALL_BUCKETS_VIEWED:"FB_STORIES.SET_ALL_BUCKETS_VIEWED",SET_UNSEEN_MODE:"FB_STORIES.SET_UNSEEN_MODE",SELECTED_THREAD_IDX_CHANGED:"FB_STORIES.SELECTED_THREAD_IDX_CHANGED",SUBSCRIPTION_BUCKET_UPDATE:"FB_STORIES.SUBSCRIPTION_BUCKET_UPDATE",UPDATE_THREAD_SEEN_OPTIMISTIC:"FB_STORIES.UPDATE_THREAD_SEEN_OPTIMISTIC",UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC:"FB_STORIES.UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC",DELETE_THREAD_FROM_BUCKET:"FB_STORIES.DELETE_THREAD_FROM_BUCKET",REMOVE_BUCKET:"FB_STORIES.REMOVE_BUCKET",SET_SATP_NATIVE_RENDER:"FB_STORIES.SET_SATP_NATIVE_RENDER",REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET:"FB_STORIES.REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET",SET_IS_COMMERCIAL_BREAK_RUNNING:"FB_STORIES.SET_IS_COMMERCIAL_BREAK_RUNNING",UNSELECT_BUCKET:"FBSTORIES.UNSELECT_BUCKET",SET_ENABLE_VIDEO_PERF_TESTS:"FB_STORIES.SET_ENABLE_VIDEO_PERF_TESTS",SET_VIEWER_OPEN:"FB_STORIES.SET_VIEWER_OPEN"});f.exports=h}),null);
__d("FBStoriesLoggingConstants",[],(function a(b,c,d,e,f,g){"use strict";var h={EVENT_STORY:"event",FOLLOWEE_STORY:"followee",FRIEND_STORY:"friend",GROUP_STORY:"group",MISSING_STORY_DATA:"missingStoryData",PAGE_STORY:"page",SELF_STORY:"self",STORY_PROMOTION:"promotion",ACTION_OPEN_MEDIA:"open_media",ACTION_DELETE_MEDIA:"delete_media_attempted",ACTION_SEND_REPLY_ATTEMPT:"attempt_to_send_reply",ACTION_SEND_REPLY_SUCCESS:"mark_reply_sent",ACTION_SEND_REPLY_FAILURE:"reply_sent_failure",ACTION_OPEN_SEEN_SUMMARY:"open_seen_summary",ACTION_OPEN_STORY:"open_story",ACTION_CLOSE_STORY:"close_story",ACTION_TRAY_LOAD:"story_tray_load",SOURCE_OPEN_FROM_STORY_HEAD:"openFromStoryHead",SOURCE_OPEN_FROM_PRIOR_STORY:"openFromPriorStory",SOURCE_CLOSE_FROM_MODAL:"closeFromClickingOnModal",SOURCE_CLOSE_FROM_MODAL_CLOSE_BUTTON:"closeFromClickingOnModal",SOURCE_CLOSE_FROM_LAST_STORY_FINISHING:"closeFromLastStoryFinishing",INTERACTIONS:{CATEGORY_KEY:"fb_stories_tray",TOTAL_INIT:"init_agg",DATA_LOADING:"graphql_data_loading",TRAY_RENDER:"react_story_tray_render",VIEWER_OPEN:"viewer_open"}};f.exports=h}),null);
__d("FBStoriesThreadHelper",["CameraPostMediaHelper","CameraPostThreadOwnerHelper","CameraPostTypes","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={getId:function i(j){var k;return((k=j)!=null?k.id:k)||""},getCameraPostType:function i(j){var k;return((k=j)!=null?k.camera_post_type:k)||c("CameraPostTypes").STORY},getCameraPostSource:function i(j){var k;return((k=j)!=null?k.post_source:k)||"CAMERA_SYSTEM"},isSeenByViewer:function i(j){var k;return!!((k=j)!=null?k.is_seen_by_viewer:k)},setIsSeenByViewer:function i(j,k){if(!j)return;j.is_seen_by_viewer=k},getLatestMessageID:function i(j){var k;return(k=j)!=null?(k=k.latest_message)!=null?k.id:k:k},getStatus:function i(j){var k;return(k=j)!=null?k.thread_status:k},getTime:function i(j){var k;return((k=j)!=null?k.time:k)||0},getExpiryTime:function i(j){var k;return((k=j)!=null?k.thread_expiry_time:k)||0},isExpired:function i(j){var k=h.getExpiryTime(j);if(!k)return false;return k<Date.now()/1e3},getFollowersSeenCount:function i(j){var k;return((k=j)!=null?k.followers_seen_count:k)||0},setFollowersSeenCount:function i(j,k){if(!j)return;j.followers_seen_count=k},getFriendsSeenCount:function i(j){var k;return((k=j)!=null?k.friends_seen_count:k)||0},setFriendsSeenCount:function i(j,k){if(!j)return;j.friends_seen_count=k},getSeenReceiptsLastSeenTime:function i(j){var k;return((k=j)!=null?k.seen_receipts_last_seen_time:k)||0},setSeenReceiptsLastSeenTime:function i(j,k){if(!j)return;j.seen_receipts_last_seen_time=k},getSeenReceiptsUnseenCount:function i(j){var k;return((k=j)!=null?k.seen_receipts_unseen_count:k)||0},setSeenReceiptsUnseenCount:function i(j,k){if(!j)return;j.seen_receipts_unseen_count=k},getOwner:function i(j){var k;return(k=j)!=null?k.camera_post_thread_owner:k},getOwnerId:function i(j){return c("CameraPostThreadOwnerHelper").getId(h.getOwner(j))},isViewerFriendOfOwner:function i(j){return c("CameraPostThreadOwnerHelper").getIsViewerFriend(h.getOwner(j))},getViewers:function i(j){var k;return((k=j)!=null?(k=k.story_thread_viewers)!=null?k.edges:k:k)||[]},setViewers:function i(j,k){if(!j)return;j.story_thread_viewers={edges:k}},getRootMessage:function i(j){var k;return(k=j)!=null?k.root_message:k},getMedia:function i(j){var k;return(k=h.getRootMessage(j))!=null?k.message_media:k},getMediaId:function i(j){return c("CameraPostMediaHelper").getId(h.getMedia(j))},getMediaType:function i(j){return c("CameraPostMediaHelper").getType(h.getMedia(j))},getMediaPreviewImage:function i(j){return c("CameraPostMediaHelper").getPreviewImage(h.getMedia(j))},getWWWTextFormatMetadata:function i(j){var k;return((k=h.getRootMessage(j))!=null?k.www_text_format_metadata:k)||null},getMessageText:function i(j){var k;return((k=h.getRootMessage(j))!=null?k.message_text:k)||""},getStoryViewerId:function i(j){var k;return(k=j)!=null?(k=k.node)!=null?k.id:k:k},getStoryViewerSeenTime:function i(j){var k;return((k=j)!=null?k.seen_time:k)||0}};f.exports=h}),null);
__d("FBStoriesBucketHelper",["CameraPostBucketOwnerHelper","CameraPostTypes","CameraPostTypesHelper","CurrentUser","FBStoriesLoggingConstants","FBStoriesThreadHelper","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={getUnseenThread:function j(k){var l=i.getThreads(k);return l[Math.max(0,i.getUnseenThreadIndex(k))]}},i={isUserBucket:function j(k){return i.getOwnerId(k)===c("CurrentUser").getID()},getLiveVideo:function j(k){var l;return(l=k)!=null?l.live_video:l},getMediaIDForLiveBucket:function j(k){var l;return(l=k)!=null?(l=l.live_video)!=null?l.id:l:l},isLive:function j(k){var l;return!!((l=i.getLiveVideo(k))!=null?l.id:l)},setLiveVideo:function j(k,l){if(!k)return;k.live_video=l},hasData:function j(k){if(!k)return false;return i.getThreads(k).length>0},getThreads:function j(k){var l,m=((l=k)!=null?(l=l.threads)!=null?l.nodes:l:l)||[];return m.filter(function(n){return c("FBStoriesThreadHelper").getStatus(n)==="PUBLISHED"&&c("FBStoriesThreadHelper").getMedia(n)!==null&&!c("FBStoriesThreadHelper").isExpired(n)})},getThreadIDs:function j(k){var l=i.getThreads(k);return l.map(function(m){var n;return((n=m)!=null?n.id:n)||""})},setThreads:function j(k,l){if(!k)return;k.threads={nodes:l}},getUnseenThreadIndex:function j(k){var l=i.getThreads(k),m=i.isUserBucket(k);return m?l.findIndex(function(n){return c("FBStoriesThreadHelper").getSeenReceiptsUnseenCount(n)>0}):l.findIndex(function(n){return!c("FBStoriesThreadHelper").isSeenByViewer(n)})},getPreviewImage:function j(k){var l=h.getUnseenThread(k);return c("FBStoriesThreadHelper").getMediaPreviewImage(l)},getId:function j(k){var l;return((l=k)!=null?l.id:l)||""},getCameraPostType:function j(k){var l;return((l=k)!=null?l.camera_post_type:l)||c("CameraPostTypes").STORY},getUnseenCount:function j(k){var l;return((l=k)!=null?l.unseen_count:l)||0},setUnseenCount:function j(k,l){if(!k)return;k.unseen_count=l},hasLiveVideoEnded:function j(k){var l;return!!((l=k)!=null?l.has_live_video_ended:l)},setHasLiveVideoEnded:function j(k,l){if(!k)return;k.has_live_video_ended=l},getOwner:function j(k){var l;return((l=k)!=null?l.camera_post_bucket_owner:l)||{id:null,name:null,short_name:null,gender:null,is_viewer_friend:false,profile_picture:null,subscribe_status:null}},getOwnerId:function j(k){return c("CameraPostBucketOwnerHelper").getId(i.getOwner(k))},getOwnerGender:function j(k){return c("CameraPostBucketOwnerHelper").getGender(i.getOwner(k))},isViewerEventHost:function j(k){return c("CameraPostBucketOwnerHelper").isEventHost(i.getOwner(k))},isViewerPageContentAdmin:function j(k){return c("CameraPostBucketOwnerHelper").isViewerPageContentAdmin(i.getOwner(k))},isViewerFriendOfOwner:function j(k){return c("CameraPostBucketOwnerHelper").isViewerFriend(i.getOwner(k))},getOwnerSubscribeStatus:function j(k){return c("CameraPostBucketOwnerHelper").getSubscribeStatus(i.getOwner(k))},getOwnerProfilePictureUri:function j(k){return c("CameraPostBucketOwnerHelper").getProfilePictureUri(i.getOwner(k))},getOwnerCoverPhotoUri:function j(k){return c("CameraPostBucketOwnerHelper").getCoverPhotoUri(i.getOwner(k))},getOwnerName:function j(k){var l=arguments.length<=1||arguments[1]===undefined?false:arguments[1],m=i.getCameraPostType(k),n=i.getOwner(k);if(!l&&c("CameraPostTypesHelper").isStory(m)&&n.short_name)return n.short_name;else return n.name},getLatestThreadCreationTime:function j(k){var l;if(!k)return null;return(l=k)!=null?l.latest_thread_creation_time:l},getLoggingType:function j(k){__p&&__p();if(!k)return c("FBStoriesLoggingConstants").MISSING_STORY_DATA;if(i.isUserBucket(k))return c("FBStoriesLoggingConstants").SELF_STORY;var l=i.getCameraPostType(k);if(c("CameraPostTypesHelper").isPageStory(l))return c("FBStoriesLoggingConstants").PAGE_STORY;if(c("CameraPostTypesHelper").isGroupStory(l))return c("FBStoriesLoggingConstants").GROUP_STORY;if(c("CameraPostTypesHelper").isEventStory(l))return c("FBStoriesLoggingConstants").EVENT_STORY;if(c("CameraPostTypesHelper").isPromotionStory(l))return c("FBStoriesLoggingConstants").STORY_PROMOTION;if(!i.isViewerFriendOfOwner(k))return c("FBStoriesLoggingConstants").FOLLOWEE_STORY;return c("FBStoriesLoggingConstants").FRIEND_STORY},getDefaultBucket:function j(){return{id:null,camera_post_type:null,unseen_count:0,ranking:null,live_video:null,camera_post_bucket_owner:null,threads:null,latest_thread_creation_time:null}}};f.exports=i}),null);
__d("friendsBucketSorter",["CameraPostTypesHelper","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(q){__p&&__p();return function r(s,t){__p&&__p();var u=s.live_video&&s.live_video.id,v=t.live_video&&t.live_video.id;if(u!==v)return u?-1:1;if(i(s,t))return k(s)?-1:1;if(j(s,t))return l(s)?-1:1;if(m(s,t,q))return n(s,q)?-1:1;return p(s)>=p(t)?-1:1}}function i(q,r){return o(q,r,k)}function j(q,r){return o(q,r,l)}function k(q){return q.unseen_count>0}function l(q){return c("CameraPostTypesHelper").isEventStory(q.camera_post_type)}function m(q,r,s){return n(q,s)!==n(r,s)}function n(q,r){var s,t=((s=q)!=null?(s=s.threads)!=null?s.nodes:s:s)||[];for(var u=0;u<t.length;u++){var v,w=(v=t[u])!=null?(v=v.camera_post_thread_owner)!=null?v.id:v:v;if(w===r)return true}return false}function o(q,r,s){var t=s(q),u=s(r);return t!=u}function p(q){var r;return((r=q)!=null?(r=r.ranking)!=null?r.score:r:r)||0}f.exports=h}),null);
__d("FBStoriesDataHelper",["CameraPostTypesHelper","FBStoriesBucketHelper","SubscribeStatuses","friendsBucketSorter","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={getBucketsDataFromLoadedObject:function i(j){__p&&__p();var k=h.getUserDataNodesFromLoadedObject(j),l=k[0],m=h.getUserInfoFromLoadedObject(j),n=h.getFriendsBucketDataFromLoadedObject(j);n=n.reduce(function(o,p){__p&&__p();var q=c("FBStoriesBucketHelper").getThreads(p),r=q&&q.length>0,s=c("FBStoriesBucketHelper").getCameraPostType(p),t=c("CameraPostTypesHelper").isStoryNux(s),u=c("CameraPostTypesHelper").isEventStory(s),v=c("CameraPostTypesHelper").isGroupStory(s),w=c("FBStoriesBucketHelper").getOwnerSubscribeStatus(p)===c("SubscribeStatuses").IS_SUBSCRIBED;if(t)return o;if(!r){if(c("FBStoriesBucketHelper").isLive(p))return o.concat([p]);return o}if(w||u||v)return o.concat([p]);return o},[]);n.sort(c("friendsBucketSorter")(m.userID));return{userInfo:m,userBucketData:l,friendsBucketData:n}},getFriendsBucketDataFromLoadedObject:function i(j){var k;return((k=j)!=null?(k=k.me)!=null?(k=k.friends_stories_buckets)!=null?k.nodes:k:k:k)||[]},getUserDataNodesFromLoadedObject:function i(j){var k;return((k=j)!=null?(k=k.me)!=null?(k=k.story_bucket)!=null?k.nodes:k:k:k)||[]},getUserInfoFromLoadedObject:function i(j){var k,l,m,n;return{userName:(k=j)!=null?(k=k.me)!=null?k.name:k:k,userID:(l=j)!=null?(l=l.me)!=null?l.id:l:l,userGender:(m=j)!=null?(m=m.me)!=null?m.gender:m:m,userProfilePic:(n=j)!=null?(n=n.me)!=null?n.profile_picture:n:n}},getFriendsDataWithEndedLiveBucket:function i(j,k,l){__p&&__p();if(!k||l||!c("FBStoriesBucketHelper").isLive(k))return j;var m=c("FBStoriesBucketHelper").getId(k),n=false;j=j.reduce(function(o,p){__p&&__p();if(c("FBStoriesBucketHelper").getId(p)===m){n=true;var q=!c("FBStoriesBucketHelper").isLive(p);if(k&&q){c("FBStoriesBucketHelper").setLiveVideo(p,k.live_video);c("FBStoriesBucketHelper").setHasLiveVideoEnded(p,true)}}o.push(p);return o},[]);if(!n){c("FBStoriesBucketHelper").setHasLiveVideoEnded(k,true);j=[k].concat(j)}return j}};f.exports=h}),null);
__d("FBStoriesDispatcher",["ExplicitRegistrationReactDispatcher"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("ExplicitRegistrationReactDispatcher"));i=h&&h.prototype;function j(k){i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this)}f.exports=new j({strict:true})}),null);
__d("FBStoriesBucketsQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1397624353698272"};j.getQueryID=function(){"use strict";return"159714964643797"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesDeleteMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1340045906066120"};j.getQueryID=function(){"use strict";return"967072946766012"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1386522808128715"};j.getQueryID=function(){"use strict";return"1384057201673076"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesTraySubscriptionWebGraphQLSubscription",["WebGraphQLSubscriptionHelper"],(function a(b,c,d,e,f,g){"use strict";f.exports=c("WebGraphQLSubscriptionHelper").getExports({docID:"1507998355922018",queryID:"1544206585695342"})}),null);
__d("FBStoriesTraySubscription",["BaseGraphQLSubscription","FBStoriesTraySubscriptionWebGraphQLSubscription","uuid"],(function a(b,c,d,e,f,g){var h=babelHelpers["extends"]({},c("BaseGraphQLSubscription"),{_getTopic:function i(j){return"gqls/stories_tray_subscribe/user_id_"+j},_getQueryID:function i(){return c("FBStoriesTraySubscriptionWebGraphQLSubscription").getDocID()},_getQueryParameters:function i(j){return{input:JSON.stringify({client_subscription_id:c("uuid")(),user_id:j})}},_getSubscriptionCallName:function i(){return"stories_tray_subscribe"}});f.exports=h}),null);
__d("FBStoriesViewerBucketViewersQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();f.exports=function(){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return"1423142174450576"};j.getQueryID=function(){"use strict";return"1524547297637879"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesGraphQLAPI",["WebGraphQL","FBStoriesBucketsQueryWebGraphQLQuery","FBStoriesViewerBucketViewersQueryWebGraphQLQuery","FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation","FBStoriesTraySubscription","FBStoriesDeleteMutationWebGraphQLMutation","CurrentUser","uniqueID"],(function a(b,c,d,e,f,g){"use strict";f.exports={load:function h(){return c("WebGraphQL").exec(new(c("FBStoriesBucketsQueryWebGraphQLQuery"))())},loadViewerListForThread:function h(i){return c("WebGraphQL").exec(new(c("FBStoriesViewerBucketViewersQueryWebGraphQLQuery"))({threadId:i}))},subscribeToTrayChanges:function h(i){c("FBStoriesTraySubscription").subscribe(c("CurrentUser").getID(),i)},updateThreadSeenReciept:function h(i){var j={client_mutation_id:c("uniqueID")(),actor_id:c("CurrentUser").getID(),thread_id:i};return c("WebGraphQL").exec(new(c("FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation"))({input:j}))},deleteStory:function h(i,j){return c("WebGraphQL").exec(new(c("FBStoriesDeleteMutationWebGraphQLMutation"))({input:{client_mutation_id:c("uniqueID")(),actor_id:i,story_thread_ids:[j]}}))}}}),null);
__d("BackstageMediaType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({LIVE:"live",PHOTO:"photo",VIDEO:"video",WAS_LIVE:"was_live",UNKNOWN:"unknown"})}),null);
__d("FBStoriesLiveVideoActionTypes",["keyMirror"],(function a(b,c,d,e,f,g){var h=c("keyMirror")({SET_UI_COMPONENTS:null,REMOVE_UI_COMPONENTS:null,LIVE_BUCKET_LOADED:null});f.exports=h}),null);
__d("fbStoriesRootSelectors",["FBStoriesBucketHelper","idx","reselect"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("reselect").createSelector,i=function i(l,u,v){var w;return v===0?l:(w=u)!=null?w[v-1]:w},j=function j(u){return u.data},k=h([j],function(u){return u.hasValue()?u.getValueEnforcing():{friendsBucketData:[],userBucketData:c("FBStoriesBucketHelper").getDefaultBucket(),userInfo:{}}}),l=h([k],function(k){return k.userBucketData||{}}),m=h([l],function(l){return l&&l.id}),n=h([k],function(k){return k.friendsBucketData||[]}),o=h([n],function(n){return n.map(function(u){return u.id?u.id:""})}),p=h([o,m],function(o,m){return[m].concat(o)}),q=h([k],function(k){return k.userInfo||{}}),r=function r(u){return u.selectedBucketIndex},s=h([r,l,n],function(r,l,n){return i(l,n,r)}),t=h([s],function(s){return s&&s.id});f.exports={userBucketData:l,friendsBucketData:n,friendsBucketIds:o,userInfo:q,bucketIds:p,selectedBucket:s,selectedBucketId:t}}),null);
__d("fbStoriesStateSelectors",["FBStoriesBucketHelper","fbStoriesRootSelectors","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("fbStoriesRootSelectors").userBucketData,i=c("fbStoriesRootSelectors").friendsBucketData,j=c("fbStoriesRootSelectors").bucketIds,k=c("fbStoriesRootSelectors").selectedBucketId,l={bucketByBucketId:function m(n,o){var p=l.bucketIndexByBucketId(n,o);return l.bucketByIndex(n,p)},bucketByIndex:function m(n,o){var p;return o===0?h(n):(p=i(n))!=null?p[o-1]:p},bucketIndexByBucketId:function m(n,o){var p=j(n);return p.indexOf(o)},isOwnBucket:function m(n,o){return(o!=undefined?o:k(n))===c("FBStoriesBucketHelper").getId(h(n))}};f.exports=l}),null);
__d("FBStoriesStore",["BackstageMediaType","CameraPostMediaHelper","CameraPostTypes","FBStoriesActionTypes","FBStoriesBucketHelper","FBStoriesDataHelper","FBStoriesDispatcher","FBStoriesLiveVideoActionTypes","FBStoriesThreadHelper","FluxReduceStore","LoadObject","Map","SubscribeStatuses","fbStoriesRootSelectors","fbStoriesStateSelectors","friendsBucketSorter","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("FluxReduceStore"));i=h&&h.prototype;j.prototype.getInitialState=function(){return{data:c("LoadObject").empty(),selectedBucketIndex:-1,currentThreadIndex:-1,unseenMode:false,allBucketsViewed:false,lastViewedThreadIndexForBucket:new(c("Map"))(),showSATPNativeRender:false,enableVideoPerfTests:false,isCommercialBreakRunning:new(c("Map"))(),isViewerOpen:false}};j.prototype.reduce=function(k,l){__p&&__p();var m,n=this,o,p,q,r;switch(l.type){case c("FBStoriesActionTypes").LOADING:return babelHelpers["extends"]({},k,{data:c("LoadObject").loading()});case c("FBStoriesActionTypes").LOADED:var s=l.data,t=s.userInfo,u=s.userBucketData,v=s.friendsBucketData;v=c("FBStoriesDataHelper").getFriendsDataWithEndedLiveBucket(v,this.$FBStoriesStore1(),this.isOwnBucket(this.getSelectedBucketId()));return babelHelpers["extends"]({},k,{data:c("LoadObject").withValue({userInfo:t,userBucketData:u,friendsBucketData:v})});case c("FBStoriesActionTypes").VIEWER_LIST_LOADED_FOR_THREAD:var m=function(){__p&&__p();var I=l.data.node,u=babelHelpers["extends"]({},n.getUserBucketData(),{threads:{nodes:n.$FBStoriesStore2().map(function(J){if(c("FBStoriesThreadHelper").getId(J)===l.threadID){var K=babelHelpers["extends"]({},J);c("FBStoriesThreadHelper").setFriendsSeenCount(K,c("FBStoriesThreadHelper").getFriendsSeenCount(I));c("FBStoriesThreadHelper").setFollowersSeenCount(K,c("FBStoriesThreadHelper").getFollowersSeenCount(I));c("FBStoriesThreadHelper").setViewers(K,c("FBStoriesThreadHelper").getViewers(I));return K}return J})}});return{v:babelHelpers["extends"]({},k,{data:c("LoadObject").withValue({userBucketData:u,userInfo:n.getUserInfo(),friendsBucketData:n.getFriendsBucketData()})})}}();if(typeof m==="object")return m.v;case c("FBStoriesActionTypes").SUBSCRIPTION_BUCKET_UPDATE:var o=function(){__p&&__p();var I=l.bucketData,J=c("FBStoriesBucketHelper").getThreads(I),K=J.length>0||c("FBStoriesBucketHelper").isLive(I),L=c("FBStoriesBucketHelper").getOwnerSubscribeStatus(I)===c("SubscribeStatuses").IS_SUBSCRIBED,M=c("FBStoriesBucketHelper").getId(I),N=c("fbStoriesRootSelectors").friendsBucketData(k),O=false,v=N.reduce(function(B,P){if(c("FBStoriesBucketHelper").getId(P)===M){O=true;if(K&&L)B.push(I)}else B.push(P);return B},[]);if(!O&&K)v=[I].concat(N);v=c("FBStoriesDataHelper").getFriendsDataWithEndedLiveBucket(v,c("fbStoriesRootSelectors").selectedBucket(k),c("fbStoriesStateSelectors").isOwnBucket(k,c("fbStoriesRootSelectors").selectedBucketId(k)));v.sort(c("friendsBucketSorter")(c("fbStoriesRootSelectors").userInfo(k).userID));return{v:babelHelpers["extends"]({},k,{data:c("LoadObject").withValue({userBucketData:c("fbStoriesRootSelectors").userBucketData(k),userInfo:c("fbStoriesRootSelectors").userInfo(k),friendsBucketData:v})})}}();if(typeof o==="object")return o.v;case c("FBStoriesActionTypes").LOADED_ERROR:return babelHelpers["extends"]({},k,{data:c("LoadObject").withError(new Error(l.error.errorSummary))});case c("FBStoriesActionTypes").RESET_LOCAL_SEEN_HISTORY:return babelHelpers["extends"]({},k,{lastViewedThreadIndexForBucket:new(c("Map"))()});case c("FBStoriesActionTypes").SELECTED_BUCKET_IDX_CHANGED:var w=l.bucketIndex;return w<0||w>=this.getBucketCount()?k:babelHelpers["extends"]({},k,{selectedBucketIndex:w});case c("FBStoriesActionTypes").SELECTED_THREAD_IDX_CHANGED:var x=this.getThreadCountForSelectedBucket();if(!this.isSelectedBucketLive()&&(l.index<0||l.index>=x))return k;var y=new(c("Map"))(k.lastViewedThreadIndexForBucket);y.set(this.getSelectedBucketIndex(),l.index);return babelHelpers["extends"]({},k,{lastViewedThreadIndexForBucket:y,currentThreadIndex:l.index});case c("FBStoriesActionTypes").SET_ALL_BUCKETS_VIEWED:var z=l.value;if(z===k.allBucketsViewed)return k;return babelHelpers["extends"]({},k,{allBucketsViewed:z,unseenMode:k.unseenMode&&z?false:k.unseenMode});case c("FBStoriesActionTypes").SET_UNSEEN_MODE:return babelHelpers["extends"]({},k,{unseenMode:l.value});case c("FBStoriesActionTypes").UPDATE_THREAD_SEEN_OPTIMISTIC:var A=this.getSelectedBucketId(),B=this.getFriendsBucketData().map(function(I){__p&&__p();var J,K=this;if(c("FBStoriesBucketHelper").getId(I)===A){var J=function(){__p&&__p();var L=c("FBStoriesBucketHelper").getUnseenCount(I),M=K.$FBStoriesStore3(I).map(function(O){if(c("FBStoriesThreadHelper").getId(O)===l.threadID){if(!c("FBStoriesThreadHelper").isSeenByViewer(O))L=Math.max(L-1,0);var P=babelHelpers["extends"]({},O);c("FBStoriesThreadHelper").setIsSeenByViewer(P,true);return P}else return O}),N=babelHelpers["extends"]({},I);c("FBStoriesBucketHelper").setUnseenCount(N,L);c("FBStoriesBucketHelper").setThreads(N,M);return{v:N}}();if(typeof J==="object")return J.v}else return I}.bind(this));return babelHelpers["extends"]({},k,{data:c("LoadObject").withValue({userBucketData:this.getUserBucketData(),userInfo:this.getUserInfo(),friendsBucketData:B})});case c("FBStoriesActionTypes").UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC:var C=babelHelpers["extends"]({},this.getUserBucketData(),{threads:{nodes:this.$FBStoriesStore2().map(function(I){if(c("FBStoriesThreadHelper").getId(I)===l.threadID){var J=babelHelpers["extends"]({},I);c("FBStoriesThreadHelper").setSeenReceiptsLastSeenTime(J,Date.now());c("FBStoriesThreadHelper").setSeenReceiptsUnseenCount(J,0);return J}else return I})}});return babelHelpers["extends"]({},k,{data:c("LoadObject").withValue({userBucketData:C,userInfo:this.getUserInfo(),friendsBucketData:this.getFriendsBucketData()})});case c("FBStoriesActionTypes").DELETE_THREAD_FROM_BUCKET:var p=function(){__p&&__p();var I=l.threadID,J=l.bucketID;if(!n.isUserManagedThread(I,J))return{v:k};var u=n.getUserBucketData(),B=null;if(J===c("FBStoriesBucketHelper").getId(u)){c("FBStoriesBucketHelper").setThreads(u,n.$FBStoriesStore3(u).filter(function(K){return c("FBStoriesThreadHelper").getId(K)!==I}));B=n.getFriendsBucketData()}else B=n.getFriendsBucketData().map(function(K){if(c("FBStoriesBucketHelper").getId(K)===J){var L=this.$FBStoriesStore3(K).filter(function(N){return c("FBStoriesThreadHelper").getId(N)!==I}),M=babelHelpers["extends"]({},K);c("FBStoriesBucketHelper").setThreads(M,L);return M}else return K}.bind(n)).filter(function(K){return this.$FBStoriesStore3(K).length>0}.bind(n));var y=k.lastViewedThreadIndexForBucket;if(I===n.getCurrentThreadIDForSelectedBucket()){y=new(c("Map"))(y);y.set(n.getSelectedBucketIndex(),undefined)}return{v:babelHelpers["extends"]({},k,{lastViewedThreadIndexForBucket:y,data:c("LoadObject").withValue({userBucketData:u,friendsBucketData:B,userInfo:n.getUserInfo()})})}}();if(typeof p==="object")return p.v;case c("FBStoriesActionTypes").REMOVE_BUCKET:var q=function(){var I=l.bucketID,B=n.getFriendsBucketData().filter(function(J){return c("FBStoriesBucketHelper").getId(J)!==I});return{v:babelHelpers["extends"]({},k,{data:c("LoadObject").withValue({userBucketData:n.getUserBucketData(),friendsBucketData:B,userInfo:n.getUserInfo()})})}}();if(typeof q==="object")return q.v;case c("FBStoriesActionTypes").SET_SATP_NATIVE_RENDER:return babelHelpers["extends"]({},k,{showSATPNativeRender:l.value});case c("FBStoriesLiveVideoActionTypes").LIVE_BUCKET_LOADED:var D=l.data,E=c("FBStoriesDataHelper").getFriendsBucketDataFromLoadedObject(D),F=[].concat(this.getFriendsBucketData()),G=E.reduce(function(I,J){if(this.$FBStoriesStore4(J)&&this.getBucketIndexByBucketId(c("FBStoriesBucketHelper").getId(J))===-1)I.push(J);return I}.bind(this),F);return babelHelpers["extends"]({},k,{data:c("LoadObject").withValue({userBucketData:this.getUserBucketData(),userInfo:this.getUserInfo(),friendsBucketData:G})});case c("FBStoriesActionTypes").REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET:var r=function(){var I=l.bucketID,B=n.getFriendsBucketData().map(function(J){if(c("FBStoriesBucketHelper").getId(J)===I){c("FBStoriesBucketHelper").setLiveVideo(J,null);c("FBStoriesBucketHelper").setHasLiveVideoEnded(J,false)}return J});return{v:babelHelpers["extends"]({},k,{data:c("LoadObject").withValue({userBucketData:n.getUserBucketData(),friendsBucketData:B,userInfo:n.getUserInfo()})})}}();if(typeof r==="object")return r.v;case c("FBStoriesActionTypes").SET_IS_COMMERCIAL_BREAK_RUNNING:var H=new(c("Map"))(this.getState().isCommercialBreakRunning);return babelHelpers["extends"]({},k,{isCommercialBreakRunning:H.set(l.videoID,l.isCommercialBreakRunning)});case c("FBStoriesActionTypes").UNSELECT_BUCKET:return babelHelpers["extends"]({},k,{selectedBucketIndex:-1,currentThreadIndex:-1});case c("FBStoriesActionTypes").SET_ENABLE_VIDEO_PERF_TESTS:return babelHelpers["extends"]({},k,{enableVideoPerfTests:l.value});case c("FBStoriesActionTypes").SET_VIEWER_OPEN:return babelHelpers["extends"]({},k,{isViewerOpen:l.value});default:return k}};j.prototype.$FBStoriesStore5=function(){var k=this.getState().data;return k.hasValue()?k.getValueEnforcing():{friendsBucketData:[],userBucketData:c("FBStoriesBucketHelper").getDefaultBucket(),userInfo:{}}};j.prototype.getUserBucketData=function(){return this.$FBStoriesStore5().userBucketData||{}};j.prototype.getUserInfo=function(){return this.$FBStoriesStore5().userInfo||{}};j.prototype.getFriendsBucketData=function(){return this.$FBStoriesStore5().friendsBucketData||[]};j.prototype.isLoading=function(){return this.getState().data.isLoading()};j.prototype.getBucketIds=function(){var k=this.getFriendsBucketData().map(function(m){return m.id?m.id:""}),l=this.getUserBucketData().id||"";return[l].concat(k)};j.prototype.getSelectedBucketIndex=function(){return this.getState().selectedBucketIndex};j.prototype.getSelectedBucketId=function(){return this.getBucketIds()[this.getSelectedBucketIndex()]};j.prototype.areAllBucketsViewed=function(){return this.getState().allBucketsViewed};j.prototype.getCameraPostTypeForBucketId=function(k){return c("FBStoriesBucketHelper").getCameraPostType(this.$FBStoriesStore6(k))};j.prototype.doesBucketContainThreadId=function(k,l){var m=this.$FBStoriesStore6(k),n=c("FBStoriesBucketHelper").getThreads(m);return n.find(function(o){return c("FBStoriesThreadHelper").getId(o)===l})!==undefined};j.prototype.$FBStoriesStore6=function(k){return this.getBucketByIndex(this.getBucketIndexByBucketId(k))};j.prototype.getBucketIndexByBucketId=function(k){return this.getBucketIds().indexOf(k)};j.prototype.getSelectedBucketCameraPostType=function(){return c("FBStoriesBucketHelper").getCameraPostType(this.$FBStoriesStore1())};j.prototype.getSelectedBucketOwner=function(){return c("FBStoriesBucketHelper").getOwner(this.$FBStoriesStore1())};j.prototype.getSelectedBucketOwnerID=function(){return c("FBStoriesBucketHelper").getOwnerId(this.$FBStoriesStore1())};j.prototype.getSelectedBucketUnseenCount=function(){return c("FBStoriesBucketHelper").getUnseenCount(this.$FBStoriesStore1())};j.prototype.getThreadsForSelectedBucket=function(){return this.$FBStoriesStore3(this.$FBStoriesStore1())};j.prototype.getCurrentThreadIndexForSelectedBucket=function(){return this.getState().currentThreadIndex};j.prototype.getCurrentThreadIDForSelectedBucket=function(){return c("FBStoriesThreadHelper").getId(this.getCurrentThreadForSelectedBucket())};j.prototype.getCurrentThreadCameraPostTypeForSelectedBucket=function(){return this.isSelectedBucketLive()?c("CameraPostTypes").STORY:c("FBStoriesThreadHelper").getCameraPostType(this.getCurrentThreadForSelectedBucket())};j.prototype.getCurrentThreadMediaTypeForSelectedBucket=function(){return this.isSelectedBucketLive()?c("BackstageMediaType").LIVE:c("FBStoriesThreadHelper").getMediaType(this.getCurrentThreadForSelectedBucket())};j.prototype.getCurrentThreadMediaIDForSelectedBucket=function(){if(this.isSelectedBucketLive()){var k=this.getThreadDataForSelectedLiveBucket();return k&&k.media.id}return c("FBStoriesThreadHelper").getMediaId(this.getCurrentThreadForSelectedBucket())};j.prototype.getCurrentThreadMediaViewerCountForSelectedBucket=function(){var k=this.getCurrentThreadForSelectedBucket();return c("FBStoriesThreadHelper").getFollowersSeenCount(k)+c("FBStoriesThreadHelper").getFriendsSeenCount(k)};j.prototype.getCurrentThreadForSelectedBucket=function(){return this.getThreadsForSelectedBucket()[this.getCurrentThreadIndexForSelectedBucket()]};j.prototype.getCurrentThreadData=function(){if(this.isSelectedBucketLive())return this.getThreadDataForSelectedLiveBucket();return this.$FBStoriesStore7(this.getState().currentThreadIndex)};j.prototype.shouldDisableReply=function(){var k=this.isOwnThread(),l=c("FBStoriesBucketHelper").isViewerFriendOfOwner(this.$FBStoriesStore1()),m=c("FBStoriesThreadHelper").isViewerFriendOfOwner(this.getCurrentThreadForSelectedBucket());return k||!l&&!m||this.isSelectedBucketLive()};j.prototype.getFollowersSeenCount=function(){return c("FBStoriesThreadHelper").getFollowersSeenCount(this.getCurrentThreadForSelectedBucket())};j.prototype.getFriendsSeenCount=function(){return c("FBStoriesThreadHelper").getFriendsSeenCount(this.getCurrentThreadForSelectedBucket())};j.prototype.isOwnBucket=function(k){return(k!=undefined?k:this.getSelectedBucketId())===c("FBStoriesBucketHelper").getId(this.getUserBucketData())};j.prototype.isOwnThread=function(){if(this.isOwnBucket())return true;var k=this.getCurrentThreadForSelectedBucket(),l=c("FBStoriesThreadHelper").getOwnerId(k);return l===this.getUserInfo().userID};j.prototype.isBucketViewerEventHost=function(){var k=this.$FBStoriesStore1();return c("FBStoriesBucketHelper").isViewerEventHost(k)};j.prototype.isCurrentThreadUserManaged=function(){return this.isUserManagedThread(this.getCurrentThreadIDForSelectedBucket()||"",this.getSelectedBucketId())};j.prototype.isUserManagedThread=function(k,l){var m=this.$FBStoriesStore6(l);if(!m)return false;var n=this.$FBStoriesStore8(k,m),o=c("FBStoriesThreadHelper").getOwnerId(n);return n&&(o===this.getUserInfo().userID||c("FBStoriesBucketHelper").getId(m)===c("FBStoriesBucketHelper").getId(this.getUserBucketData())||c("FBStoriesBucketHelper").isViewerEventHost(m)||c("FBStoriesBucketHelper").isViewerPageContentAdmin(m))||false};j.prototype.getBucketCount=function(){return this.getFriendsBucketData().length+1};j.prototype.hasDataInSelectedBucket=function(){return c("FBStoriesBucketHelper").hasData(this.$FBStoriesStore1())};j.prototype.hasOwnBucketViewers=function(){if(this.userBucketIsLive())return false;var k=this.$FBStoriesStore2(),l=k.filter(function(m){return c("FBStoriesThreadHelper").getSeenReceiptsUnseenCount(m)>0});return l.length>0};j.prototype.hasOwnBucketContent=function(){return this.$FBStoriesStore2().length>0||this.userBucketIsLive()};j.prototype.getThreadCountForSelectedBucket=function(){return this.getThreadsForSelectedBucket().length};j.prototype.userBucketIsLive=function(){return this.$FBStoriesStore4(this.getUserBucketData())};j.prototype.isSelectedBucketLive=function(){return this.$FBStoriesStore4(this.$FBStoriesStore1())};j.prototype.getSelectedBucketOwnerType=function(){return c("FBStoriesBucketHelper").getLoggingType(this.$FBStoriesStore1())};j.prototype.$FBStoriesStore4=function(k){return c("FBStoriesBucketHelper").isLive(k)};j.prototype.getCurrentThreadViewers=function(){__p&&__p();var k={hasNewViewers:false,hasNewFriendViewers:false,hasNewConnectionsViewers:false,friends:[],connections:[],totalCount:0,totalNew:0,followersCount:0};if(!this.isOwnThread())return k;var l=this.getCurrentThreadForSelectedBucket(),m=c("FBStoriesThreadHelper").getViewers(l),n=this.getUserInfo().userID;k=m.reduce(function(p,q){__p&&__p();var r=c("FBStoriesThreadHelper").getStoryViewerId(q);if(r!==n){var s,t=((s=q)!=null?(s=s.node)!=null?s.is_viewer_friend:s:s)||false,u=t?"friends":"connections",v=c("FBStoriesThreadHelper").getStoryViewerSeenTime(q),w=v>=c("FBStoriesThreadHelper").getSeenReceiptsLastSeenTime(l);p[u].push(babelHelpers["extends"]({},q.node,{seenTime:v,isNewViewer:w}));p.totalNew+=w?1:0;p.hasNewViewers=p.hasNewViewers||w;p.hasNewFriendViewers=p.hasNewFriendViewers||w&&t;p.hasNewConnectionsViewers=p.hasNewViewers||w&&!t}return p},k);var o=this.getFollowersSeenCount();return Object.assign(k,{totalCount:o+m.length,followersCount:o})};j.prototype.isUnseenMode=function(){return this.getState().unseenMode};j.prototype.getThreadCount=function(k){__p&&__p();var l=this.getBucketByIndex(k);if(this.$FBStoriesStore4(l))return 0;if(k===0){var m=this.$FBStoriesStore3(this.getUserBucketData());return m.length}if(k>0){var n=this.$FBStoriesStore3(l);return n.length}return-1};j.prototype.getUnseenThreadIndex=function(k){return c("FBStoriesBucketHelper").getUnseenThreadIndex(this.getBucketByIndex(k))};j.prototype.getAllowedNavigationType=function(){var k=this.getSelectedBucketIndex(),l=k===0||k==1&&!c("FBStoriesBucketHelper").hasData(this.getUserBucketData()),m=k===this.getBucketCount()-1,n=l&&this.getCurrentThreadIndexForSelectedBucket()==0,o=m&&this.getCurrentThreadIndexForSelectedBucket()===this.getThreadsForSelectedBucket().length-1;if(n)return"NEXT_ONLY";if(o)return"PREV_ONLY";return"BOTH"};j.prototype.getLastSeenThreadIndexForBucket=function(k){var l=this.getState().lastViewedThreadIndexForBucket,m=l.get(k);return m==undefined?0:m};j.prototype.$FBStoriesStore2=function(){return this.$FBStoriesStore3(this.getUserBucketData())};j.prototype.$FBStoriesStore1=function(){return this.getBucketByIndex(this.getSelectedBucketIndex())};j.prototype.getBucketByIndex=function(k){var l;return k===0?this.getUserBucketData():(l=this.getFriendsBucketData())!=null?l[k-1]:l};j.prototype.$FBStoriesStore8=function(k,l){var m=this.$FBStoriesStore3(l),n=m.filter(function(o){return o.id===k});return n.length>0?n[0]:null};j.prototype.$FBStoriesStore3=function(k){return c("FBStoriesBucketHelper").getThreads(k)};j.prototype.$FBStoriesStore7=function(k){var l=this.getSelectedBucketOwner(),m=this.getThreadsForSelectedBucket()[k];if(!m)return null;var n=c("FBStoriesThreadHelper").getMedia(m),o=c("FBStoriesThreadHelper").getWWWTextFormatMetadata(m),p=c("FBStoriesThreadHelper").getMessageText(m);return{isLive:false,media:n,bucketOwner:l,threadOwner:c("FBStoriesThreadHelper").getOwner(m)||{name:null,id:null,is_viewer_friend:false,profile_picture:null},participants:[],isSeen:c("FBStoriesThreadHelper").isSeenByViewer(m),latestMessageID:c("FBStoriesThreadHelper").getLatestMessageID(m),time:c("FBStoriesThreadHelper").getTime(m),threadID:c("FBStoriesThreadHelper").getId(m),cameraPostType:c("FBStoriesThreadHelper").getCameraPostType(m),cameraPostSource:c("FBStoriesThreadHelper").getCameraPostSource(m),wwwTextFormatMetadata:o,messageText:p}};j.prototype.getThreadDataForSelectedLiveBucket=function(){var k=this.$FBStoriesStore1();return this.$FBStoriesStore9(k)};j.prototype.$FBStoriesStore9=function(k){if(!k)return null;var l=c("FBStoriesBucketHelper").getLiveVideo(k);if(!l||!this.$FBStoriesStore4(k))return null;var m=this.getSelectedBucketOwner();return{isLive:true,media:l,bucketOwner:m,isSeen:false,cameraPostType:c("FBStoriesBucketHelper").getCameraPostType(k)}};j.prototype.isSelectedBucketLiveAndEnded=function(){return this.isSelectedBucketLive()&&c("FBStoriesBucketHelper").hasLiveVideoEnded(this.$FBStoriesStore1())};j.prototype.getSATPNativeRender=function(){return this.getState().showSATPNativeRender};j.prototype.getVideoPerfTestsEnabled=function(){return this.getState().enableVideoPerfTests};j.prototype.getIsCommercialBreakRunning=function(k){return!!this.getState().isCommercialBreakRunning.get(k)};j.prototype.getVideoMediaIdForBucketIndexAndThreadIndex=function(k,l){__p&&__p();var m=this.getBucketByIndex(k);if(!m)return null;if(this.$FBStoriesStore4(m)){var n,o=this.$FBStoriesStore9(m);return(n=o)!=null?(n=n.media)!=null?n.id:n:n}var p=this.$FBStoriesStore3(m);if(l<0||l>=p.length)return null;var q=c("FBStoriesThreadHelper").getMedia(p[l]);if(!q)return null;if(!c("CameraPostMediaHelper").isVideo(q))return null;return q.id};j.prototype.isViewerOpen=function(){return this.getState().isViewerOpen};function j(){h.apply(this,arguments)}f.exports=new j(c("FBStoriesDispatcher"))}),null);
__d("FBStoriesVisibilityHelper",["FBStoriesActionTypes","FBStoriesDataHelper","FBStoriesDispatcher","FBStoriesGraphQLAPI","FBStoriesStore","Visibility","emptyFunction","throttle"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=false,i=60,j={addListenerToReloadDataOnVisible:function k(l){if(h)return;if(l===undefined)l=this._defaultDataLoad.bind(this);c("Visibility").addListener(c("Visibility").VISIBLE,c("throttle").withBlocking(function(){if(c("FBStoriesStore").isLoading()===false&&c("FBStoriesStore").isViewerOpen()===false)if(l!==undefined)l()},i*1e3));h=true},_defaultDataLoad:function k(){c("FBStoriesGraphQLAPI").load().done(function(l){var m=c("FBStoriesDataHelper").getBucketsDataFromLoadedObject(l);c("FBStoriesDispatcher").dispatch({type:c("FBStoriesActionTypes").LOADED,data:m})},function(l){return c("emptyFunction")})}};f.exports=j}),null);
__d("FBStoriesAppController",["Bootloader","FBStoriesActionTypes","FBStoriesDataHelper","FBStoriesVisibilityHelper","FBStoriesDispatcher","FBStoriesGraphQLAPI","idx","FBStoriesStore"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("FBStoriesDispatcher").dispatch;f.exports={init:function i(j){__p&&__p();c("FBStoriesDispatcher").explicitlyRegisterStores([c("FBStoriesStore")]);h({type:c("FBStoriesActionTypes").LOADING});var k=j.preloader;k.onLoaded(function(l){var m=l.result,n=c("FBStoriesDataHelper").getBucketsDataFromLoadedObject(m.data);c("Bootloader").loadModules(["FBStoriesLoggingHelper"],function(o){o.logStoryTrayLoad(n)},"FBStoriesAppController");h({type:c("FBStoriesActionTypes").LOADED,data:n})});k.onError(function(l){return h({type:c("FBStoriesActionTypes").LOADED_ERROR,error:l})});c("FBStoriesGraphQLAPI").subscribeToTrayChanges(function(l){var m;h({type:c("FBStoriesActionTypes").SUBSCRIPTION_BUCKET_UPDATE,bucketData:(m=l)!=null?(m=m.stories_tray_subscribe)!=null?m.bucket:m:m})});c("FBStoriesVisibilityHelper").addListenerToReloadDataOnVisible();h({type:c("FBStoriesActionTypes").SET_SATP_NATIVE_RENDER,value:j.showSATPNativeRender});h({type:c("FBStoriesActionTypes").SET_ENABLE_VIDEO_PERF_TESTS,value:j.enableVideoPerfTests})}}}),null);
__d("FBStoriesVerticalLayout.react",["cx","fbt","React"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k,l=3,m=48+8,n=l*m;j=babelHelpers.inherits(o,c("React").Component);k=j&&j.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=k.constructor).call.apply(p,[this].concat(s)),this.state={seeMore:false},this.$FBStoriesVerticalLayout1=function(){return this.setState({seeMore:true})}.bind(this),q}o.prototype.render=function(){var p=this.props.children,q=c("React").Children.count(p),r=this.state.seeMore?q*m:Math.min(q*m,n),s=!this.state.seeMore&&q>l,t=c("React").createElement("div",{key:"list",className:"_1fvt"+(this.props.showPreviews?" with-preview":"")+" vertical"+(this.state.seeMore?" seeMore":""),style:{maxHeight:r}},p),u=s&&c("React").createElement("a",{key:"link",className:"_31yr",href:"#",onClick:this.$FBStoriesVerticalLayout1},c("React").createElement("span",{className:"_jyz"}),i._("See More"));return[t,u]};f.exports=o}),null);
__d("FBStoriesCameraActionTypes",[],(function a(b,c,d,e,f,g){"use strict";var h=Object.freeze({SET_MEDIASTREAM:"SET_MEDIASTREAM",SET_VIDEOSOURCE:"SET_VIDEOSOURCE"});f.exports=h}),null);
__d("FBStoriesCameraDispatcher",["ExplicitRegistrationReactDispatcher"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("ExplicitRegistrationReactDispatcher"));i=h&&h.prototype;function j(){h.apply(this,arguments)}f.exports=new j({strict:false})}),null);
__d("FBStoriesCameraActions",["invariant","emptyFunction","FBStoriesCameraActionTypes","FBStoriesCameraDispatcher"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i={setMediaStream:function j(k){c("FBStoriesCameraDispatcher").dispatch({type:c("FBStoriesCameraActionTypes").SET_MEDIASTREAM,mediaStream:k})},setVideoSource:function j(k){c("FBStoriesCameraDispatcher").dispatch({type:c("FBStoriesCameraActionTypes").SET_VIDEOSOURCE,videoSource:k})},startCameraStream:function j(){var k=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;k||h(0);k.call(navigator,{video:true,audio:true},function(l){if(l.getVideoTracks().length>0){var m=window.URL.createObjectURL(l);i.setVideoSource(m);i.setMediaStream(l)}},c("emptyFunction"))},stopCameraStream:function j(k,l){__p&&__p();if(k instanceof MediaStream){k.getVideoTracks().forEach(function(m){return m.stop()});k.getAudioTracks().forEach(function(m){return m.stop()})}if(l){window.URL.revokeObjectURL(l);i.setVideoSource(undefined)}}};f.exports=i}),null);
__d("FBStoriesCameraStore",["FBStoriesCameraActionTypes","FBStoriesCameraDispatcher","FluxReduceStore","immutable"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j,k;h=babelHelpers.inherits(l,c("immutable").Record({mediaStream:undefined,videoSource:undefined}));i=h&&h.prototype;function l(){h.apply(this,arguments)}j=babelHelpers.inherits(m,c("FluxReduceStore"));k=j&&j.prototype;m.prototype.getInitialState=function(){return new l()};m.prototype.reduce=function(n,o){switch(o.type){case c("FBStoriesCameraActionTypes").SET_MEDIASTREAM:return n.set("mediaStream",o.mediaStream);case c("FBStoriesCameraActionTypes").SET_VIDEOSOURCE:return n.set("videoSource",o.videoSource);default:return n}};m.prototype.getMediaStream=function(){return this.getState().mediaStream};m.prototype.getVideoSource=function(){return this.getState().videoSource};function m(){j.apply(this,arguments)}f.exports=new m(c("FBStoriesCameraDispatcher"))}),null);
__d("FBStoriesCameraMedia.react",["cx","React"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;k.prototype.render=function(){if(this.props.videoSource)return c("React").createElement("video",{autoPlay:true,loop:true,muted:true,className:"_3yws",src:this.props.videoSource});return c("React").createElement("span",null,"Webcam is starting up...")};function k(){i.apply(this,arguments)}f.exports=k}),null);
__d("FBStoriesCameraView.react",["fbt","FBStoriesCameraMedia.react","React","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogOkayButton.react","XUIDialogTitle.react"],(function a(b,c,d,e,f,g,h){"use strict";var i,j,k=600,l=h._("Facebook Camera");i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;m.prototype.render=function(){return c("React").createElement(c("XUIDialog.react"),{hideOnEscape:true,isStrictlyControlled:true,label:l,onBlur:this.props.closeCamera,onHide:this.props.closeCamera,overflow:"hidden",shown:this.props.isCameraOpen,width:k},c("React").createElement(c("XUIDialogTitle.react"),null,l),c("React").createElement(c("XUIDialogBody.react"),null,c("React").createElement(c("FBStoriesCameraMedia.react"),{videoSource:this.props.videoSource})),c("React").createElement(c("XUIDialogFooter.react"),null,c("React").createElement(c("XUIDialogOkayButton.react"),{action:"cancel",onClick:this.props.closeCamera,use:"confirm"})))};function m(){i.apply(this,arguments)}f.exports=m}),null);
__d("FBStoriesCamera.react",["FBStoriesCameraActions","FBStoriesCameraStore","FBStoriesCameraView.react","FluxContainer","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.getStores=function(){return[c("FBStoriesCameraStore")]};j.calculateState=function(){return{mediaStream:c("FBStoriesCameraStore").getMediaStream(),videoSource:c("FBStoriesCameraStore").getVideoSource()}};j.prototype.componentWillMount=function(){c("FBStoriesCameraActions").startCameraStream()};j.prototype.componentWillUnmount=function(){c("FBStoriesCameraActions").stopCameraStream(this.state.mediaStream,this.state.videoSource)};j.prototype.render=function(){return c("React").createElement(c("FBStoriesCameraView.react"),{closeCamera:this.props.closeCamera,isCameraOpen:this.props.isCameraOpen,videoSource:this.state.videoSource})};function j(){h.apply(this,arguments)}f.exports=c("FluxContainer").create(j)}),null);
__d("FBStoryAddStoryItem.react",["cx","fbt","FBStoriesCamera.react","Image.react","React","ShimButton.react"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;function l(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.state={isCameraOpen:false},this.$FBStoryAddStoryItem4=function(){if(this.state.isCameraOpen)return;this.setState({isCameraOpen:true})}.bind(this),this.$FBStoryAddStoryItem5=function(){if(!this.state.isCameraOpen)return;this.setState({isCameraOpen:false})}.bind(this),n}l.prototype.render=function(){return c("React").createElement("div",{className:"_48if"},this.$FBStoryAddStoryItem1(),this.$FBStoryAddStoryItem2(),this.$FBStoryAddStoryItem3())};l.prototype.$FBStoryAddStoryItem1=function(){var m=c("React").createElement(c("Image.react"),{src:this.props.imageUrl,className:"_64x7"}),n=c("React").createElement("div",{className:"_64x8"});return c("React").createElement(c("ShimButton.react"),{className:"_64x9",onClick:this.$FBStoryAddStoryItem4,onKeyPress:this.$FBStoryAddStoryItem4},m,n)};l.prototype.$FBStoryAddStoryItem2=function(){return c("React").createElement("div",{className:"_64xa"},c("React").createElement("span",{className:"_64xb"},i._("Add Story")))};l.prototype.$FBStoryAddStoryItem3=function(){return this.state.isCameraOpen&&c("React").createElement(c("FBStoriesCamera.react"),{isCameraOpen:this.state.isCameraOpen,closeCamera:this.$FBStoryAddStoryItem5})};f.exports=l}),null);
__d("FBStoryTrayFriendItemSubtitle.react",["cx","React","formatDate","Timestamp.react"],(function a(b,c,d,e,f,g,h){"use strict";function i(j){var k=j.lastUpdateTime,l=[k&&c("React").createElement(c("Timestamp.react"),{key:"timestamp",autoUpdate:true,time:k,text:c("formatDate")(k,"M j, Y",{utc:true})})];return c("React").createElement("div",{className:"_31yn"},l)}f.exports=i}),null);
__d("FBStoryTrayItem.react",["cx","fbt","ix","Bootloader","CameraPostTypesHelper","Image.react","IntlVariations","Tooltip.react","React","fbglyph","emptyFunction","XUISpinner.react"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l;k=babelHelpers.inherits(m,c("React").PureComponent);l=k&&k.prototype;function m(){__p&&__p();var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=l.constructor).call.apply(n,[this].concat(q)),this.state={shouldRenderWithTooltip:false},this.$FBStoryTrayItem2=function(){if(!this.state.shouldRenderWithTooltip)this.setState({shouldRenderWithTooltip:true});if(this.props.onHover)this.props.onHover(this.props.bucketID)}.bind(this),this.$FBStoryTrayItem3=function(){if(this.props.onHoverOut)this.props.onHoverOut(this.props.bucketID)}.bind(this),this.$FBStoryTrayItem4=function(){if(!this.props.disabled&&!this.props.loading)this.props.onSelect(this.props.bucketID)}.bind(this),o}m.prototype.componentDidMount=function(){if(this.props.liveVideoID)c("Bootloader").loadModules(["VideoPlayerMetaData"],function(n){n.genVideoData(this.props.liveVideoID).done()}.bind(this),"FBStoryTrayItem.react")};m.prototype.render=function(){if(!this.props.bucketID)return null;var n=this.props.isBucketLive,o=!!this.props.imageUrl,p=this.props.secondaryImageUrl&&!n,q="_1fw9"+(this.props.highlighted?" _1fw0":"")+(n?" _erm":"")+(o?" _1fwa":""),r=o?c("React").createElement(c("Image.react"),{src:this.props.imageUrl,className:"_1fwb"}):null,s=p?[c("React").createElement(c("Image.react"),{key:"img",src:this.props.secondaryImageUrl,className:"_1fwc"}),c("React").createElement(c("Image.react"),{key:"icon",className:"_4uz_",src:j("354763"),width:24})]:null,t=this.$FBStoryTrayItem1(),u=c("React").createElement("div",{className:q},r,this.props.showBlueIndicator&&c("React").createElement("div",{className:"_3xlk"}),t,this.props.loading&&c("React").createElement("div",{className:"_1dbr"},c("React").createElement(c("XUISpinner.react"),{size:"large",background:o?"light":"dark",className:"_1dbs"})),n&&c("React").createElement("div",{className:"_ern"},c("React").createElement(c("Image.react"),{alt:i._("LIVE"),src:j("118398")})),s),v=c("React").createElement("div",{className:"_efz"},c("React").createElement("span",{className:"_ef_ _4u-0"},i._("Your Story")),this.props.subtitleComponent),w=c("React").createElement("div",{dir:"auto",className:"_1fw3"},c("React").createElement("span",{className:"_4u-0"},this.props.actorName),this.props.subtitleComponent),x=c("IntlVariations").GENDER_UNKNOWN;if(this.props.actorGender==="MALE")x=c("IntlVariations").GENDER_MALE;else if(this.props.actorGender==="FEMALE")x=c("IntlVariations").GENDER_FEMALE;var y=this.props.isOwnBucket?i._("Watch Your Story"):i._({"*":"Watch {actor name}'s Story"},[i.param("actor name",this.props.actorName,[1,x])]),z=this.props.isOwnBucket?v:w,A=this.state.shouldRenderWithTooltip&&!this.props.fullWidth?c("React").createElement("div",{className:"_3zck"},c("React").createElement(c("Tooltip.react"),{tooltip:y,alignH:"center"},u,z)):c("React").createElement("div",null,u,z);return c("React").createElement("div",{role:"button",tabIndex:"0",onMouseEnter:this.$FBStoryTrayItem2,onMouseLeave:this.$FBStoryTrayItem3,onClick:this.$FBStoryTrayItem4,onKeyPress:this.$FBStoryTrayItem4,className:"_1fvw"+(this.props.disabled?" _4lu8":"")+(this.props.loading?" loading":"")},A)};m.prototype.$FBStoryTrayItem1=function(){var n=c("CameraPostTypesHelper").isEventStory(this.props.cameraPostType),o=c("CameraPostTypesHelper").isGroupStory(this.props.cameraPostType),p=!!this.props.imageUrl,q=c("React").createElement("div",{className:(n?"_1464":"")+(o?" _27v0":"")}),r=p?c("React").createElement("div",{className:"_1dbr"},q):c("React").createElement("div",{className:"_1fwb"+(n?" _144-":"")+(o?" _27v2":"")},q);return n||o?r:null};m.defaultProps={disabled:false,actorName:"",actorGender:"",highlighted:false,showBlueIndicator:false,isOwnBucket:false,isBucketLive:false,onHover:c("emptyFunction"),onHoverOut:c("emptyFunction"),loading:false,fullWidth:false,subtitleComponent:null};f.exports=m}),null);
__d("FBStoryTrayOwnerItemSubtitle.react",["cx","fbt","React","formatDate","Timestamp.react"],(function a(b,c,d,e,f,g,h,i){"use strict";function j(k){var l=k.lastUpdateTime,m=[l&&c("React").createElement(c("Timestamp.react"),{key:"timestamp",autoUpdate:true,time:l,text:c("formatDate")(l,"M j, Y",{utc:true})})];return c("React").createElement("div",{className:"_31yn"},m)}f.exports=j}),null);
__d("HorizontalScroll.react",["ix","cx","fbt","asset","compactArray","emptyFunction","range","Bootloader","BootloadOnRender.react","Image.react","JSResource","LazyComponent.react","React"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l,m=400;k=babelHelpers.inherits(n,c("React").Component);l=k&&k.prototype;function n(o){l.constructor.call(this,o);this.defaultProps={placeholderFactory:c("emptyFunction")};this.$HorizontalScroll4=function(){if(!this.state.scrolling&&this.$HorizontalScroll1)this.setState({scrollLeft:this.$HorizontalScroll1.scrollLeft})}.bind(this);this.state={itemCount:0,offsetWidth:0,scrolling:false,scrollLeft:0,scrollWidth:0,viewportItemsCount:0};this.$HorizontalScroll2=this.$HorizontalScroll2.bind(this);this.$HorizontalScroll3=this.$HorizontalScroll3.bind(this)}n.prototype.componentDidMount=function(){var o=this.props.itemMarginWidth,p=this.props.itemWidth,q=this.$HorizontalScroll1.offsetWidth,r=0;if(p<=q)r=1+Math.floor((q-p)/(p+o));this.setState({offsetWidth:q,scrollLeft:this.$HorizontalScroll1.scrollLeft,scrollWidth:this.$HorizontalScroll1.scrollWidth,viewportItemsCount:r})};n.prototype.componentDidUpdate=function(o,p){if(p.scrollLeft!==this.state.scrollLeft)if(this.$HorizontalScroll1){c("Bootloader").loadModules(["Animation","Ease"],function(q,r){new q(this.$HorizontalScroll1).duration(m).ease(r.circOut).ondone(function(){this.setState({scrolling:false})}.bind(this)).to("scrollLeft",this.state.scrollLeft).go()}.bind(this),"HorizontalScroll.react");this.setState({scrolling:true})}};n.prototype.componentWillUpdate=function(o,p){var q=o.children?c("compactArray")(c("React").Children.toArray(o.children)):[],r=q.length;if(r!=this.state.itemCount)this.setState({itemCount:r})};n.prototype.render=function(){var o=this.state.scrollLeft===0,p=this.state.scrollLeft>=this.getMaxLeft()||this.state.itemCount<=this.state.viewportItemsCount,q=c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{"aria-label":j._("See more results from the left"),className:"_1rk2 _6107","data-testid":"horizontalScroll/leftArrow",href:{url:"#"},image:c("React").createElement(c("Image.react"),{src:h("374382")}),label:"With a Hidden Label",labelIsHidden:true,onClick:this.$HorizontalScroll2}),loader:c("JSResource")("XUIButton.react").__setRef("HorizontalScroll.react"),placeholder:c("React").createElement("span",null)}),r=c("React").createElement(c("BootloadOnRender.react"),{component:c("React").createElement(c("LazyComponent.react"),{"aria-label":j._("See more results from the right"),className:"_1rkd _6107","data-testid":"horizontalScroll/rightArrow",href:{url:"#"},image:c("React").createElement(c("Image.react"),{src:h("374391")}),label:"With a Hidden Label",labelIsHidden:true,onClick:this.$HorizontalScroll3}),loader:c("JSResource")("XUIButton.react").__setRef("HorizontalScroll.react"),placeholder:c("React").createElement("span",null)});return c("React").createElement("div",{className:"_lmj"+(this.state.viewportItemsCount===4?" _1iug":"")+(this.state.scrolling?" _3_9y":""),onScroll:this.$HorizontalScroll4,ref:function(s){return this.$HorizontalScroll1=s}.bind(this)},this.props.children,this.$HorizontalScroll5(),!o&&q,!p&&r)};n.prototype.getMaxLeft=function(){return this.state.scrollWidth-this.state.offsetWidth-this.props.itemMarginWidth};n.prototype.$HorizontalScroll5=function(){var o=Math.max(0,this.state.viewportItemsCount-this.state.itemCount);return c("range")(0,o).map(this.props.placeholderFactory)};n.prototype.$HorizontalScroll6=function(o){var p=this.state.viewportItemsCount*(this.props.itemWidth+this.props.itemMarginWidth),q=this.getMaxLeft(),r=o?q-(this.state.scrollLeft+p):this.state.scrollLeft-p;return r<this.props.itemWidth?q:p};n.prototype.$HorizontalScroll2=function(){var o=Math.max(0,this.$HorizontalScroll1.scrollLeft-this.$HorizontalScroll6(false));this.setState({scrollLeft:o})};n.prototype.$HorizontalScroll3=function(){var o=Math.min(this.getMaxLeft(),this.$HorizontalScroll1.scrollLeft+this.$HorizontalScroll6(true));this.setState({scrollLeft:o})};f.exports=n}),null);
__d("FBStoriesTray.react",["cx","FBStoriesVerticalLayout.react","React","emptyFunction","FBStoriesBucketHelper","FBStoriesThreadHelper","FBStoryTrayItem.react","HorizontalScroll.react","FBStoryAddStoryItem.react","FBStoryTrayOwnerItemSubtitle.react","FBStoryTrayFriendItemSubtitle.react"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=64,l=8;i=babelHelpers.inherits(m,c("React").Component);j=i&&i.prototype;m.prototype.render=function(){__p&&__p();var n=this.props,o=n.friendsData,p=n.userBucketHasContent,q=!o||o.length===0;if(q&&!p)return null;var r=[];if(this.props.showProduction)r.push(this.$FBStoriesTray1());if(this.props.userBucketHasContent)r.push(this.$FBStoriesTray2());r=r.concat([].concat(this.$FBStoriesTray3()));if(this.props.vertical)return c("React").createElement(c("FBStoriesVerticalLayout.react"),{showPreviews:this.$FBStoriesTray4()},r);var s=k,t=l,u="_1fvt";return c("React").createElement("div",{className:u},c("React").createElement(c("HorizontalScroll.react"),{itemWidth:s,itemMarginWidth:t,placeholderFactory:this.$FBStoriesTray5},r))};m.prototype.$FBStoriesTray5=function(n){return c("React").createElement("div",{key:n,className:"_1fvw"},c("React").createElement("div",{className:"_rqg"}))};m.prototype.$FBStoriesTray1=function(){var n=c("FBStoriesBucketHelper").getOwnerProfilePictureUri(this.props.userBucket);return c("React").createElement(c("FBStoryAddStoryItem.react"),{imageUrl:n,key:"production"})};m.prototype.$FBStoriesTray2=function(){var n=this.props,o=n.userBucket,p=n.userBucketHasNewViewers,q=n.userBucketIsLive,r=c("FBStoriesBucketHelper").getOwnerProfilePictureUri(o),s=c("FBStoriesBucketHelper").getPreviewImage(o),t=c("FBStoriesBucketHelper").getCameraPostType(o),u=c("FBStoriesBucketHelper").getId(o),v=c("FBStoriesBucketHelper").getMediaIDForLiveBucket(o),w=c("FBStoriesBucketHelper").getLatestThreadCreationTime(o),x=void 0,y=void 0;if(this.$FBStoriesTray4()){x=r;y=s}else{x=r;y=null}return c("React").createElement(c("FBStoryTrayItem.react"),{highlighted:p,showBlueIndicator:p,bucketID:u,key:u,imageUrl:x,secondaryImageUrl:y,isOwnBucket:true,isBucketLive:q,liveVideoID:v,onHover:this.props.onItemHover,onHoverOut:this.props.onItemHoverOut,onSelect:this.props.onItemSelect,cameraPostType:t,loading:this.props.loadingBucketID===u,fullWidth:this.props.vertical,subtitleComponent:this.props.vertical&&c("React").createElement(c("FBStoryTrayOwnerItemSubtitle.react"),{lastUpdateTime:w})})};m.prototype.$FBStoriesTray3=function(){__p&&__p();return this.props.friendsData.map(function(n,o){__p&&__p();var p=c("FBStoriesBucketHelper").getId(n);if(!p)return null;var q=c("FBStoriesBucketHelper").getCameraPostType(n),r=c("FBStoriesBucketHelper").getOwnerId(n),s=c("FBStoriesBucketHelper").getOwnerName(n,this.props.vertical);if(!r||!s)return null;var t=c("FBStoriesBucketHelper").isLive(n),u=c("FBStoriesBucketHelper").getOwnerProfilePictureUri(n),v=void 0,w=void 0;if(this.$FBStoriesTray4()){v=u;w=c("FBStoriesBucketHelper").getPreviewImage(n)}else{v=u;w=null}var x=c("FBStoriesBucketHelper").getThreads(n),y=x.filter(function(B){return!c("FBStoriesThreadHelper").isSeenByViewer(B)}).length>0,z=c("FBStoriesBucketHelper").getLatestThreadCreationTime(n),A={bucketID:p,actorName:s,actorGender:c("FBStoriesBucketHelper").getOwnerGender(n),imageUrl:v,liveVideoID:c("FBStoriesBucketHelper").getMediaIDForLiveBucket(n),secondaryImageUrl:w,highlighted:y,isBucketLive:t,key:r,onHover:this.props.onItemHover,onHoverOut:this.props.onItemHoverOut,onSelect:this.props.onItemSelect,cameraPostType:q,loading:this.props.loadingBucketID===p,fullWidth:this.props.vertical,subtitleComponent:this.props.vertical&&c("React").createElement(c("FBStoryTrayFriendItemSubtitle.react"),{lastUpdateTime:z})};return c("React").createElement(c("FBStoryTrayItem.react"),A)}.bind(this))};m.prototype.$FBStoriesTray4=function(){return this.props.vertical&&this.props.showAsPreviews&&!this.props.userBucketIsLive};function m(){i.apply(this,arguments)}m.defaultProps={onItemHover:c("emptyFunction"),onItemHoverOut:c("emptyFunction"),loadingBucketID:null,vertical:false,showProduction:false};f.exports=m}),null);
__d("FBStoriesTrayHeader.react",["ix","cx","fbt","React","Tooltip.react","Image.react","fbglyph"],(function a(b,c,d,e,f,g,h,i,j){"use strict";var k=function k(){var l=c("React").createElement(c("Image.react"),{className:"_2ms3",src:h("126682")});return c("React").createElement("div",{className:"_2mro"},c("React").createElement("span",{className:"_2ms2"},j._("Stories")),c("React").createElement(c("Tooltip.react"),{tooltip:j._("Stories are photos and videos that are visible for 24 hours. When someone adds to a story, it'll show up here.")},l))};f.exports=k}),null);
__d("FBStoriesTrayContainer.react",["cx","Bootloader","FBStoriesBucketHelper","FBStoriesLoggingConstants","FBStoriesStore","FBStoriesTray.react","FBStoriesTrayHeader.react","FluxContainer","React","range"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").PureComponent);j=i&&i.prototype;function k(){__p&&__p();var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={friendsData:[],userBucket:c("FBStoriesBucketHelper").getDefaultBucket(),userBucketHasNewViewers:false,userBucketHasContent:false,loading:true,bucketIdBeingLoaded:null,userBucketIsLive:false},this.$FBStoriesTrayContainer2=function(r){this.setState({bucketIdBeingLoaded:r});c("Bootloader").loadModules(["FBStoriesActions","FBStoriesLoggingHelper"],function(s,t){if(s.userSelectedBucket(r)){s.toggleViewer(true);t.storyLog(c("FBStoriesLoggingConstants").ACTION_OPEN_STORY,c("FBStoriesLoggingConstants").SOURCE_OPEN_FROM_STORY_HEAD)}this.setState({bucketIdBeingLoaded:null})}.bind(this),"FBStoriesTrayContainer.react")}.bind(this),n}k.getStores=function(){return[c("FBStoriesStore")]};k.calculateState=function(m){return{userBucket:c("FBStoriesStore").getUserBucketData(),userBucketHasNewViewers:c("FBStoriesStore").hasOwnBucketViewers(),userBucketHasContent:c("FBStoriesStore").hasOwnBucketContent(),friendsData:c("FBStoriesStore").getFriendsBucketData(),loading:c("FBStoriesStore").isLoading(),userBucketIsLive:c("FBStoriesStore").userBucketIsLive()}};k.prototype.render=function(){var m="_60kg"+(this.props.showVerticalTray?" vertical":"");if(this.state.loading)return c("React").createElement("div",{className:m},c("React").createElement(c("FBStoriesTrayHeader.react"),null),c("React").createElement(l,null));if(this.$FBStoriesTrayContainer1())return c("React").createElement("div",{className:m});return c("React").createElement("div",{className:m},c("React").createElement(c("FBStoriesTrayHeader.react"),null),c("React").createElement(c("FBStoriesTray.react"),{vertical:this.props.showVerticalTray,showAsPreviews:this.props.showAsPreviews,showProduction:this.props.showProduction,friendsData:this.state.friendsData,userBucket:this.state.userBucket,userBucketHasContent:this.state.userBucketHasContent,userBucketHasNewViewers:this.state.userBucketHasNewViewers,loading:this.state.loading,loadingBucketID:this.state.bucketIdBeingLoaded,userBucketIsLive:this.state.userBucketIsLive,onItemSelect:this.$FBStoriesTrayContainer2}))};k.prototype.$FBStoriesTrayContainer1=function(){var m=this.state,n=m.friendsData,o=m.userBucket,p=m.loading,q=!c("FBStoriesBucketHelper").hasData(o),r=!n||n.length===0,s=q&&r;return!p&&s};k.defaultProps={showAsPreviews:false,showProduction:false,showVerticalTray:false};var l=function l(m){var n=function n(o){return c("React").createElement("div",{className:"_h0-",key:o},c("React").createElement("div",{className:"_2ms4"},c("React").createElement("div",{className:"_2ms5"})),c("React").createElement("div",{className:"_2ms6"}),c("React").createElement("div",{className:"_2ms8"}))};return c("React").createElement("div",{className:"_h1i"},c("React").createElement("div",{className:"_h1m"},c("range")(0,10).map(n)))};f.exports=c("FluxContainer").create(k)}),null);