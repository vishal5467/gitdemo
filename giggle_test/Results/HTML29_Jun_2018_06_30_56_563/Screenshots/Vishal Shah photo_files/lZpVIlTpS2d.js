if (self.CavalryLogger) { CavalryLogger.start_js(["SbcZP"]); }

__d("LoggedInAccountSwitcherEvents",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ADD_ACCOUNT:"add_account",CLOSE_BLUEBAR_DIALOG:"close_bluebar_dialog",OPEN_BLUEBAR_DIALOG:"open_bluebar_dialog",REMOVE_ACCOUNT:"remove_account",SWITCH_ACCOUNT:"switch_account",SWITCH_WORKPLACE:"switch_workplace"})}),null);
__d("LoggedInAccountSwitcherSurfaces",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({SETTINGS_MENU:"settings_menu",BLUEBAR:"bluebar"})}),null);
__d("LoggedInAccountSwitcherTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:LoggedInAccountSwitcherLoggerConfig",this.$LoggedInAccountSwitcherTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:LoggedInAccountSwitcherLoggerConfig",this.$LoggedInAccountSwitcherTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$LoggedInAccountSwitcherTypedLogger1={};return this};h.prototype.updateData=function(j){this.$LoggedInAccountSwitcherTypedLogger1=babelHelpers["extends"]({},this.$LoggedInAccountSwitcherTypedLogger1,j);return this};h.prototype.setBadgeHasCount=function(j){this.$LoggedInAccountSwitcherTypedLogger1.badge_has_count=j;return this};h.prototype.setBadgeShown=function(j){this.$LoggedInAccountSwitcherTypedLogger1.badge_shown=j;return this};h.prototype.setEvent=function(j){this.$LoggedInAccountSwitcherTypedLogger1.event=j;return this};h.prototype.setSurface=function(j){this.$LoggedInAccountSwitcherTypedLogger1.surface=j;return this};h.prototype.setUsersCount=function(j){this.$LoggedInAccountSwitcherTypedLogger1.users_count=j;return this};h.prototype.setVC=function(j){this.$LoggedInAccountSwitcherTypedLogger1.vc=j;return this};var i={badge_has_count:true,badge_shown:true,event:true,surface:true,users_count:true,vc:true};f.exports=h}),null);
__d("XLoggedInAccountSwitcherBlueBarBadgeController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/logged_in_account_switcher/badge/",{})}),null);
__d("XLoggedInAccountSwitcherBlueBarContentController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/logged_in_account_switcher/content/",{})}),null);
__d("XLoggedInAccountSwitcherRemoveUserDialogController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/login/logged_in_account_switcher/remove_user/",{cuid:{type:"String",required:true},__asyncDialog:{type:"Int"}})}),null);
__d("XLoginAccountSelectorRemoveAsyncController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/login/device-based/async/remove/",{cuid:{type:"String"},flow:{type:"Enum",enumType:1}})}),null);
__d("LoggedInAccountSwitcher",["csx","cx","Arbiter","AsyncDialog","AsyncRequest","CSS","DOM","DOMQuery","Event","LoggedInAccountSwitcherEvents","LoggedInAccountSwitcherSurfaces","LoggedInAccountSwitcherTypedLogger","ServiceWorkerLoginAndLogout","XLoggedInAccountSwitcherBlueBarBadgeController","XLoggedInAccountSwitcherBlueBarContentController","XLoggedInAccountSwitcherRemoveUserDialogController","XLoginAccountSelectorRemoveAsyncController","setImmediate"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j="logged_in_account_switcher:remove_account",k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q={},r={shown:false,has_count:false},s={initBlueBarSwitcher:function t(u,v,w,x){l=u;n=v;o=w;p=x;this.initDialog(u,w);this._mousemoveListener=c("Event").listen(l,"mousemove",this._onBlueBarMouseMove.bind(this));c("setImmediate")(this._loadBadge)},_loadBadge:function t(){var u=c("XLoggedInAccountSwitcherBlueBarBadgeController").getURIBuilder().getURI();new(c("AsyncRequest"))().setURI(u).setMethod("POST").setRelativeTo(l).send()},_onBlueBarMouseMove:function t(){this._mousemoveListener.remove();this._loadDialogContentIfNeeded()},_loadDialogContentIfNeeded:function t(){if(!m){m=true;var u=c("XLoggedInAccountSwitcherBlueBarContentController").getURIBuilder().getURI();new(c("AsyncRequest"))().setURI(u).setMethod("POST").setRelativeTo(l).send()}},onBlueBarSwitcherLoad:function t(){c("setImmediate")(function(){o.setInnerContent(n.children[0]);c("DOM").empty(n)})},initBlueBarUser:function t(u,v,w){this.initElementContainingForm(u,c("LoggedInAccountSwitcherEvents").SWITCH_ACCOUNT);if(v!=null&&w!=null)this.initRemoveAccountElement(v,u,w,c("LoggedInAccountSwitcherSurfaces").BLUEBAR)},initRemoveAccountElement:function t(u,v,w,x){__p&&__p();var y=c("Arbiter").subscribe(j,function(z,A){if(A.cuid===w){c("DOM").remove(v);y.unsubscribe()}});c("Event").listen(u,"click",function(z){z.stopPropagation();if(!k){k=true;this._removeUserFromAccountSwitcher(w,x)}return false}.bind(this))},initElementContainingForm:function t(u,v){__p&&__p();c("Event").listen(u,"click",function(w){__p&&__p();w.stopPropagation();var x=c("DOMQuery").scry(w.target,"^._43up").length>0;if(!k&&!x){var y=c("DOMQuery").find(u,"form");if(y){this._logEvent(v,c("LoggedInAccountSwitcherSurfaces").BLUEBAR);k=true;c("Event").fire(y,"submit");y.submit();c("ServiceWorkerLoginAndLogout").logout()}}return false}.bind(this))},initMenu:function t(u){__p&&__p();var v=u.surface||c("LoggedInAccountSwitcherSurfaces").SETTINGS_MENU;u.menu.subscribe("itemclick",function(w,x){__p&&__p();var y=x.item,z=y.getValue();if(z==="account_switcher"||z==="account_switcher_add_account"){var event=c("LoggedInAccountSwitcherEvents").SWITCH_ACCOUNT;if(z==="account_switcher_add_account")event=c("LoggedInAccountSwitcherEvents").ADD_ACCOUNT;var A=c("DOMQuery").find(y.getRoot(),"form");if(A){this._logEvent(event,v);c("Event").fire(A,"submit");A.submit();c("ServiceWorkerLoginAndLogout").logout()}}}.bind(this))},initMenuRemoveAccountElement:function t(u,v,w){__p&&__p();c("Event").listen(u,"click",function(y){y.stopPropagation();var z=c("XLoggedInAccountSwitcherRemoveUserDialogController").getURIBuilder().setString("cuid",v).getURI();c("AsyncDialog").send(new(c("AsyncRequest"))(z),function(A){A.subscribe("confirm",function(){A.hide();this._removeUserFromAccountSwitcher(v,c("LoggedInAccountSwitcherSurfaces").SETTINGS_MENU)}.bind(this))}.bind(this))}.bind(this));var x=c("Arbiter").subscribe(j,function(y,z){var A="^._1msi";if(w===c("LoggedInAccountSwitcherSurfaces").BLUEBAR)A="^._62ra";if(v===z.cuid){var B=c("DOMQuery").find(u,A);c("DOM").remove(B);x.unsubscribe()}})},initDialog:function t(u,v){__p&&__p();v.subscribe("hide",function(){c("CSS").removeClass(l,"_1dqw");this._logEvent(c("LoggedInAccountSwitcherEvents").CLOSE_BLUEBAR_DIALOG,c("LoggedInAccountSwitcherSurfaces").BLUEBAR);this._clearBadge()}.bind(this));v.subscribe("show",function(){c("CSS").addClass(l,"_1dqw");this._clearBadge();this._hideNux()}.bind(this));c("Event").listen(u,"click",function(){this._logEvent(c("LoggedInAccountSwitcherEvents").OPEN_BLUEBAR_DIALOG,c("LoggedInAccountSwitcherSurfaces").BLUEBAR);this._loadDialogContentIfNeeded();v.show()}.bind(this))},setUsersCountForSurface:function t(u,v){q[v]=u},setBadgeState:function t(u){r=u},_hideNux:function t(){if(p!=null)p.hide()},_clearBadge:function t(){var u=c("DOMQuery").scry(l,"._1dqx")[0];if(u!=null)c("DOM").empty(u);r={shown:false,has_count:false}},_logEvent:function t(event,u){var v=new(c("LoggedInAccountSwitcherTypedLogger"))(),w=q[u]||0;if(u===c("LoggedInAccountSwitcherSurfaces").BLUEBAR)v.setBadgeShown(r.shown).setBadgeHasCount(r.has_count);v.setEvent(event).setSurface(u).setUsersCount(w).log()},_removeUserFromAccountSwitcher:function t(u,v){this._logEvent(c("LoggedInAccountSwitcherEvents").REMOVE_ACCOUNT,v);var w=c("XLoginAccountSelectorRemoveAsyncController").getURIBuilder().getURI();new(c("AsyncRequest"))().setURI(w).setData({cuid:u,flow:"logged_in_account_switcher"}).setMethod("POST").setHandler(function(){k=false}).send();c("Arbiter").inform(j,{cuid:u})}};f.exports=s}),null);